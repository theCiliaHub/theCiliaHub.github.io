<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The CiliaHub: A Database of Genes with Ciliary Functions</title>
    <meta name="description" content="The CiliaHub is a comprehensive bioinformatics database for genes with ciliary functions, providing resources for ciliopathy research, genome exploration, and gene search.">
    <meta name="keywords" content="cilia gene, ciliopathy, database, search, genome, bioinformatics, ciliary function, ciliary genes">
    <link rel="icon" type="image/png" href="CiliaHub_Logo_web.png">
    <link rel="stylesheet" href="styles.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script>
    <script src="https://unpkg.com/@upsetjs/bundle"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX'); // âœ¨ Replace with your real Google Analytics ID
    </script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="/#" onclick="navigateTo(event, '/')" class="logo" aria-label="CiliaHub Home">CiliaHub</a>
            <ul class="nav-links">
                <li><a href="/#" onclick="navigateTo(event, '/')" aria-label="Home">Home</a></li>
                <li><a href="/#/enrichment" onclick="navigateTo(event, '/enrichment')" aria-label="Enrichment">Enrichment</a></li>
                <li><a href="/#/batch-query" onclick="navigateTo(event, '/batch-query')" aria-label="Batch Query">Batch Query</a></li>
                <li><a href="/#/compare" onclick="navigateTo(event, '/compare')" aria-label="Compare">Compare</a></li>
                <li><a href="/#/expression" onclick="navigateTo(event, '/expression')" aria-label="Expression">Expression</a></li>
                <li><a href="/#/download" onclick="navigateTo(event, '/download')" aria-label="Download">Download</a></li>
                <li><a href="/#/contact" onclick="navigateTo(event, '/contact')" aria-label="Contact">Contact</a></li>
            </ul>
        </div>
    </nav>

    <main class="main-container">
        <div class="content-area" id="content-area">
            
            <div id="home-page">
                <h1>Welcome to CiliaHub ðŸ”¬</h1>
                <p>Your comprehensive resource for genes with ciliary functions. Explore our database, compare genes, and visualize expression data.</p>
                <div class="call-to-action">
                    <p>Get started by analyzing your gene list to discover ciliary localization patterns.</p>
                    <a href="/#/analysis" onclick="navigateTo(event, '/analysis')" class="cta-button">Perform Gene Enrichment Analysis</a>
                </div>
            </div>

            <div id="analysis-page" style="display: none;">
                <h2>Gene Enrichment Analysis</h2>
                <div class="analysis-input">
                    <label for="analysis-genes-input">Enter Gene List (one per line or comma-separated):</label>
                    <textarea id="analysis-genes-input" rows="5" placeholder="e.g., BBS1, BBS2, ARL6"></textarea>
                </div>
                <div class="plot-type-selection">
                    <h3>Select Plot Type:</h3>
                    <label><input type="radio" name="plot-type" value="bubble" checked> Bubble Enrichment Plot</label>
                    <label><input type="radio" name="plot-type" value="matrix"> Matrix Plot</label>
                </div>
                <div class="plot-settings">
                    <h3>Plot Customization</h3>
                    <p style="font-size: 0.9rem; color: #555; margin-bottom: 15px;">Customize the plot appearance and click "Generate Plot" to apply changes.</p>
                    
                    <!-- Font Settings -->
                    <details open style="margin-bottom: 15px;">
                        <summary style="font-weight: bold; cursor: pointer; padding: 8px; background-color: #e1ecf4; border-radius: 4px;">Font Settings</summary>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; padding: 10px;">
                            <div>
                                <label for="setting-font-family">Font Family</label>
                                <select id="setting-font-family" aria-label="Select plot font family">
                                    <option value="Arial" selected>Arial</option>
                                    <option value="Tahoma">Tahoma</option>
                                    <option value="Helvetica">Helvetica</option>
                                    <option value="Verdana">Verdana</option>
                                </select>
                            </div>
                            <div>
                                <label for="setting-font-size">Font Size (px)</label>
                                <input type="number" id="setting-font-size" value="14" min="8" max="30" step="1" aria-label="Set plot font size">
                            </div>
                            <div>
                                <label for="setting-font-weight">Font Weight</label>
                                <select id="setting-font-weight" aria-label="Select plot font weight">
                                    <option value="normal">Normal</option>
                                    <option value="bold" selected>Bold</option>
                                </select>
                            </div>
                            <div>
                                <label for="setting-text-color">Text Color</label>
                                <input type="color" id="setting-text-color" value="#000000" aria-label="Select plot text color">
                            </div>
                        </div>
                    </details>

                    <!-- Axis Settings -->
                    <details open style="margin-bottom: 15px;">
                        <summary style="font-weight: bold; cursor: pointer; padding: 8px; background-color: #e1ecf4; border-radius: 4px;">Axis Settings</summary>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; padding: 10px;">
                            <div>
                                <label for="setting-axis-color">Axis Color</label>
                                <input type="color" id="setting-axis-color" value="#000000" aria-label="Select axis color">
                            </div>
                            <div>
                                <label for="setting-x-axis-title">X-Axis Title</label>
                                <input type="text" id="setting-x-axis-title" value="Enrichment" aria-label="Set X-axis title">
                            </div>
                            <div>
                                <label for="setting-y-axis-title">Y-Axis Title</label>
                                <input type="text" id="setting-y-axis-title" value="Localization" aria-label="Set Y-axis title">
                            </div>
                            <div>
                                <label for="setting-x-axis-size">X-Axis Tick Size (px)</label>
                                <input type="number" id="setting-x-axis-size" value="12" min="8" max="24" step="1" aria-label="Set X-axis tick font size">
                            </div>
                            <div>
                                <label for="setting-y-axis-size">Y-Axis Tick Size (px)</label>
                                <input type="number" id="setting-y-axis-size" value="12" min="8" max="24" step="1" aria-label="Set Y-axis tick font size">
                            </div>
                        </div>
                    </details>

                    <!-- Color Settings -->
                    <details open style="margin-bottom: 15px;">
                        <summary style="font-weight: bold; cursor: pointer; padding: 8px; background-color: #e1ecf4; border-radius: 4px;">Color Settings</summary>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; padding: 10px;">
                            <div>
                                <label for="setting-bar-color">Bar Color</label>
                                <input type="color" id="setting-bar-color" value="#2ca25f" aria-label="Select bar color for ciliome plot">
                            </div>
                            <div>
                                <label for="setting-enrichment-color1">Enrichment Color 1 (Low)</label>
                                <input type="color" id="setting-enrichment-color1" value="#edf8fb" aria-label="Select low enrichment color">
                            </div>
                            <div>
                                <label for="setting-enrichment-color2">Enrichment Color 2</label>
                                <input type="color" id="setting-enrichment-color2" value="#b2e2e2" aria-label="Select enrichment color 2">
                            </div>
                            <div>
                                <label for="setting-enrichment-color3">Enrichment Color 3</label>
                                <input type="color" id="setting-enrichment-color3" value="#66c2a4" aria-label="Select enrichment color 3">
                            </div>
                            <div>
                                <label for="setting-enrichment-color4">Enrichment Color 4</label>
                                <input type="color" id="setting-enrichment-color4" value="#2ca25f" aria-label="Select enrichment color 4">
                            </div>
                            <div>
                                <label for="setting-enrichment-color5">Enrichment Color 5 (High)</label>
                                <input type="color" id="setting-enrichment-color5" value="#006d2c" aria-label="Select high enrichment color">
                            </div>
                        </div>
                    </details>
                </div>
                <button onclick="generateAnalysisPlots()">Generate Plot</button>
                <div id="analysis-status" style="display: none;"></div>
                <div id="plot-container" style="display: none;">
                    <div id="bubble-enrichment-container" style="display: flex; width: 100%; height: 500px;">
                        <canvas id="analysis-bubble-plot" style="flex-grow: 1;"></canvas>
                        <div id="legend-container" style="min-width: 150px; padding-left: 20px;"></div>
                    </div>
                    <div id="matrix-plot-container" style="display: none; width: 100%; height: 500px;">
                        <canvas id="analysis-matrix-plot"></canvas>
                    </div>
                </div>
                
                <div id="gene-table-container" style="display: none; width: 80%; margin: 40px auto 0;"></div>

                <div class="download-section">
                     <button id="download-plot-btn" onclick="downloadPlot()" style="display: none; margin-right: 10px;">Download Plot</button>
                     <select id="download-format">
                         <option value="png">PNG</option>
                         <option value="pdf">PDF</option>
                     </select>
                </div>
            </div>
        </div>
        
        <aside class="cilia-panel">
            <div class="panel-header">
                <h3>Interactive Cilium</h3>
                <p style="font-size: 0.9rem; opacity: 0.9;">Click genes to see localization</p>
            </div>
            <div class="panel-content">
                <div class="cilia-container interactive-cilium">
                    <svg viewBox="0 0 300 400" xmlns="http://www.w3.org/2000/svg">
                        <path id="cell-body" class="cilia-part" tabindex="0" fill="none" d="M 50,380 C -20,300 20,200 150,200 C 280,200 320,300 250,380 Z" aria-label="Cell Body"/>
                        <circle id="nucleus" class="cilia-part" tabindex="0" fill="#A7C7E7" cx="150" cy="320" r="40" aria-label="Nucleus"/>
                        <rect id="basal-body" class="cilia-part" tabindex="0" fill="#2F2F2F" x="140" y="195" width="20" height="15" aria-label="Basal Body"/>
                        <path id="transition-zone" class="cilia-part" tabindex="0" fill="#9B59B6" d="M 142,195 L 138,180 L 162,180 L 158,195 Z" aria-label="Transition Zone"/>
                        <path id="ciliary-membrane" class="cilia-part" tabindex="0" fill="none" fill-opacity="0.5" d="M 138,180 L 145,10 L 155,10 L 162,180 Z" aria-label="Ciliary Membrane"/>
                        <path id="axoneme" class="cilia-part" tabindex="0" fill="none" d="M 145,180 L 148,15 L 152,15 L 155,180 Z" aria-label="Axoneme"/>
                    </svg>
                </div>
                <div class="controls">
                    <h4>Gene Localization:</h4>
                    <div id="geneButtons" class="gene-buttons"></div>
                </div>
            </div>
        </aside>
    </main>

    <footer class="footer">
        <p>&copy; 2025 CiliaHub. All rights reserved.</p>
    </footer>

    <script src="plots.js"></script>
    <script src="script.js"></script>
</body>
</html>
